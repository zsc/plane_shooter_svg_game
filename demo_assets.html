<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆèµ„æºæ¼”ç¤º - å…¨æ°‘é£æœºå¤§æˆ˜</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Microsoft YaHei', sans-serif;
            color: white;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 20px;
        }
        .demo-section {
            margin-bottom: 40px;
        }
        .demo-section h2 {
            color: #FFD700;
            border-bottom: 2px solid #FFD700;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        #gameCanvas {
            display: block;
            margin: 20px auto;
            border: 2px solid #FFD700;
            background: #001a33;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .controls button {
            margin: 0 10px;
            padding: 10px 20px;
            font-size: 16px;
            background: rgba(255,215,0,0.8);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .controls button:hover {
            background: #FFD700;
            transform: scale(1.05);
        }
        .info {
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background: rgba(0,0,0,0.5);
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>ğŸ® æ¸¸æˆèµ„æºæ¼”ç¤º</h1>
        
        <div class="demo-section">
            <h2>èµ„æºå±•ç¤ºç”»å¸ƒ</h2>
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            
            <div class="controls">
                <button onclick="showPlayerAssets()">ç©å®¶æˆ˜æœº</button>
                <button onclick="showEnemyAssets()">æ•Œæœºå±•ç¤º</button>
                <button onclick="showBulletAssets()">å­å¼¹æ•ˆæœ</button>
                <button onclick="showCombatDemo()">æˆ˜æ–—æ¼”ç¤º</button>
                <button onclick="clearCanvas()">æ¸…ç©ºç”»å¸ƒ</button>
            </div>
            
            <div class="info">
                <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æŸ¥çœ‹ä¸åŒçš„æ¸¸æˆèµ„æº</p>
                <p>å½“å‰å±•ç¤º: <span id="currentDemo">æ— </span></p>
            </div>
        </div>
    </div>

    <!-- åŠ è½½æ¸¸æˆè„šæœ¬ -->
    <script src="js/core/GameConfig.js"></script>
    <script src="js/assets/AssetManager.js"></script>
    <script src="js/render/Renderer.js"></script>
    
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const assetManager = new AssetManager();
        let animationId = null;
        
        // åˆå§‹åŒ–èµ„æº
        assetManager.init().then(() => {
            console.log('èµ„æºåŠ è½½å®Œæˆ');
            document.getElementById('currentDemo').textContent = 'èµ„æºå·²åŠ è½½';
        });
        
        // æ¸…ç©ºç”»å¸ƒ
        function clearCanvas() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // ç»˜åˆ¶èƒŒæ™¯
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#001a33');
            gradient.addColorStop(1, '#003366');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            document.getElementById('currentDemo').textContent = 'å·²æ¸…ç©º';
        }
        
        // å±•ç¤ºç©å®¶æˆ˜æœº
        function showPlayerAssets() {
            clearCanvas();
            document.getElementById('currentDemo').textContent = 'ç©å®¶æˆ˜æœº';
            
            // ç»˜åˆ¶ä¸‰ç§æˆ˜æœº
            const types = ['fighter', 'bomber', 'interceptor'];
            const names = ['æˆ˜æ–—æœº', 'è½°ç‚¸æœº', 'æ‹¦æˆªæœº'];
            
            types.forEach((type, index) => {
                const x = 200 + index * 200;
                const y = 200;
                
                // ç»˜åˆ¶æˆ˜æœº
                assetManager.drawAsset(ctx, `player.${type}`, x, y, 0, 1.5);
                
                // ç»˜åˆ¶æ ‡ç­¾
                ctx.fillStyle = '#FFD700';
                ctx.font = '20px Microsoft YaHei';
                ctx.textAlign = 'center';
                ctx.fillText(names[index], x, y + 80);
                ctx.fillText(`æ•°å­—é”® ${index + 1}`, x, y + 105);
            });
        }
        
        // å±•ç¤ºæ•Œæœº
        function showEnemyAssets() {
            clearCanvas();
            document.getElementById('currentDemo').textContent = 'æ•Œæœºç±»å‹';
            
            const enemies = [
                { type: 'scout', name: 'ä¾¦å¯Ÿæœº', tier: 1 },
                { type: 'fighter', name: 'æˆ˜æ–—æœº', tier: 2 },
                { type: 'bomber', name: 'è½°ç‚¸æœº', tier: 2 },
                { type: 'interceptor', name: 'æ‹¦æˆªæœº', tier: 3 },
                { type: 'stealth', name: 'éšå½¢æœº', tier: 4 },
                { type: 'commander', name: 'æŒ‡æŒ¥æœº', tier: 5 }
            ];
            
            enemies.forEach((enemy, index) => {
                const x = 150 + (index % 3) * 250;
                const y = 200 + Math.floor(index / 3) * 200;
                
                // ç»˜åˆ¶æ•Œæœº
                assetManager.drawAsset(ctx, `enemies.${enemy.type}`, x, y, 0, 1.2);
                
                // ç»˜åˆ¶ä¿¡æ¯
                ctx.fillStyle = '#FFD700';
                ctx.font = '16px Microsoft YaHei';
                ctx.textAlign = 'center';
                ctx.fillText(enemy.name, x, y + 60);
                ctx.fillStyle = '#888888';
                ctx.font = '14px Microsoft YaHei';
                ctx.fillText(`Tier ${enemy.tier}`, x, y + 80);
            });
        }
        
        // å±•ç¤ºå­å¼¹æ•ˆæœ
        function showBulletAssets() {
            clearCanvas();
            document.getElementById('currentDemo').textContent = 'å­å¼¹ç±»å‹';
            
            let bulletY = 500;
            
            function animateBullets() {
                clearCanvas();
                
                // æ›´æ–°å­å¼¹ä½ç½®
                bulletY -= 5;
                if (bulletY < 100) bulletY = 500;
                
                // ç»˜åˆ¶ä¸åŒç±»å‹çš„å­å¼¹
                const bullets = [
                    { type: 'standard', name: 'æ ‡å‡†å¼¹', x: 200 },
                    { type: 'laser', name: 'æ¿€å…‰', x: 300 },
                    { type: 'missile', name: 'å¯¼å¼¹', x: 400 },
                    { type: 'enemyBullet', name: 'æ•Œå¼¹', x: 500 }
                ];
                
                bullets.forEach(bullet => {
                    // ç»˜åˆ¶å­å¼¹
                    assetManager.drawAsset(
                        ctx, 
                        `bullets.${bullet.type}`, 
                        bullet.x, 
                        bulletY,
                        0,
                        2
                    );
                    
                    // ç»˜åˆ¶æ ‡ç­¾
                    ctx.fillStyle = '#FFD700';
                    ctx.font = '16px Microsoft YaHei';
                    ctx.textAlign = 'center';
                    ctx.fillText(bullet.name, bullet.x, 550);
                });
                
                animationId = requestAnimationFrame(animateBullets);
            }
            
            animateBullets();
        }
        
        // æˆ˜æ–—æ¼”ç¤º
        function showCombatDemo() {
            clearCanvas();
            document.getElementById('currentDemo').textContent = 'æˆ˜æ–—åœºæ™¯';
            
            let time = 0;
            const player = { x: 400, y: 500, type: 'fighter' };
            const enemies = [
                { x: 200, y: 150, type: 'scout', vx: 1 },
                { x: 400, y: 100, type: 'fighter', vx: -0.5 },
                { x: 600, y: 200, type: 'interceptor', vx: 0.8 }
            ];
            const bullets = [];
            
            function animate() {
                clearCanvas();
                time++;
                
                // æ›´æ–°æ•Œæœºä½ç½®
                enemies.forEach(enemy => {
                    enemy.x += enemy.vx;
                    if (enemy.x < 50 || enemy.x > 750) enemy.vx *= -1;
                });
                
                // ç”Ÿæˆå­å¼¹
                if (time % 30 === 0) {
                    bullets.push({
                        x: player.x,
                        y: player.y - 30,
                        vy: -8
                    });
                }
                
                // æ›´æ–°å­å¼¹
                for (let i = bullets.length - 1; i >= 0; i--) {
                    bullets[i].y += bullets[i].vy;
                    if (bullets[i].y < 0) bullets.splice(i, 1);
                }
                
                // ç»˜åˆ¶æ•Œæœº
                enemies.forEach(enemy => {
                    assetManager.drawAsset(ctx, `enemies.${enemy.type}`, enemy.x, enemy.y, 0, 1);
                });
                
                // ç»˜åˆ¶å­å¼¹
                bullets.forEach(bullet => {
                    assetManager.drawAsset(ctx, 'bullets.standard', bullet.x, bullet.y, 0, 1);
                });
                
                // ç»˜åˆ¶ç©å®¶
                const wobble = Math.sin(time * 0.1) * 20;
                assetManager.drawAsset(ctx, `player.${player.type}`, player.x + wobble, player.y, 0, 1);
                
                // æ˜¾ç¤ºä¿¡æ¯
                ctx.fillStyle = '#00FF00';
                ctx.font = '16px Microsoft YaHei';
                ctx.textAlign = 'left';
                ctx.fillText('å®æ—¶æˆ˜æ–—æ¼”ç¤º', 20, 30);
                
                animationId = requestAnimationFrame(animate);
            }
            
            animate();
        }
        
        // åˆå§‹æ˜¾ç¤º
        clearCanvas();
    </script>
</body>
</html>